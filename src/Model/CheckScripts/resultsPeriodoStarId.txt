


create table resumen_error
(
   empresa_id int,
   periodo_star_id int,
   table_name  varchar(30),
   registros_error int
);



create table resumen_ok
(
   empresa_id int,
   periodo_star_id int,
   table_name  varchar(30),
   registros_ok int
);








insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ALIMENTADOR', count(*), 0, 0
 from ALIMENTADOR a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'ALIMENTADOR', count(*)
 from ALIMENTADOR a, errores b
 where b.table_name = 'ALIMENTADOR'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ALIMENTADOR', count(*)
 from ALIMENTADOR a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ALIMENTADOR_AFECTADO', count(*), 0, 0
 from ALIMENTADOR_AFECTADO a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'ALIMENTADOR_AFECTADO', count(*)
 from ALIMENTADOR_AFECTADO a, errores b
 where b.table_name = 'ALIMENTADOR_AFECTADO'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ALIMENTADOR_AFECTADO', count(*)
 from ALIMENTADOR_AFECTADO a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ALIMENTADOR_INCIDENCIA', count(*), 0, 0
 from ALIMENTADOR_INCIDENCIA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'ALIMENTADOR_INCIDENCIA', count(*)
 from ALIMENTADOR_INCIDENCIA a, errores b
 where b.table_name = 'ALIMENTADOR_INCIDENCIA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ALIMENTADOR_INCIDENCIA', count(*)
 from ALIMENTADOR_INCIDENCIA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ALIMENTADOR_REPOSICION', count(*), 0, 0
 from ALIMENTADOR_REPOSICION a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'ALIMENTADOR_REPOSICION', count(*)
 from ALIMENTADOR_REPOSICION a, errores b
 where b.table_name = 'ALIMENTADOR_REPOSICION'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ALIMENTADOR_REPOSICION', count(*)
 from ALIMENTADOR_REPOSICION a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'AVISO', count(*), 0, 0
 from AVISO a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'AVISO', count(*)
 from AVISO a, errores b
 where b.table_name = 'AVISO'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'AVISO', count(*)
 from AVISO a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'BAJADA', count(*), 0, 0
 from BAJADA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'BAJADA', count(*)
 from BAJADA a, errores b
 where b.table_name = 'BAJADA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'BAJADA', count(*)
 from BAJADA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'BLOQUE_REPOSICION', count(*), 0, 0
 from BLOQUE_REPOSICION a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'BLOQUE_REPOSICION', count(*)
 from BLOQUE_REPOSICION a, errores b
 where b.table_name = 'BLOQUE_REPOSICION'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'BLOQUE_REPOSICION', count(*)
 from BLOQUE_REPOSICION a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'BOVEDA', count(*), 0, 0
 from BOVEDA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'BOVEDA', count(*)
 from BOVEDA a, errores b
 where b.table_name = 'BOVEDA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'BOVEDA', count(*)
 from BOVEDA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'CAMARA', count(*), 0, 0
 from CAMARA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'CAMARA', count(*)
 from CAMARA a, errores b
 where b.table_name = 'CAMARA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'CAMARA', count(*)
 from CAMARA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'CANALIZACION', count(*), 0, 0
 from CANALIZACION a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'CANALIZACION', count(*)
 from CANALIZACION a, errores b
 where b.table_name = 'CANALIZACION'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'CANALIZACION', count(*)
 from CANALIZACION a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;












insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'CONEXION_NODO_IEC', count(*), 0, 0
 from CONEXION_NODO_IEC a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'CONEXION_NODO_IEC', count(*)
 from CONEXION_NODO_IEC a, errores b
 where b.table_name = 'CONEXION_NODO_IEC'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'CONEXION_NODO_IEC', count(*)
 from CONEXION_NODO_IEC a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'CONEXION_NODO_INCIDENCIA', count(*), 0, 0
 from CONEXION_NODO_INCIDENCIA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'CONEXION_NODO_INCIDENCIA', count(*)
 from CONEXION_NODO_INCIDENCIA a, errores b
 where b.table_name = 'CONEXION_NODO_INCIDENCIA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'CONEXION_NODO_INCIDENCIA', count(*)
 from CONEXION_NODO_INCIDENCIA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'DESCRIPCION_EVENTO', count(*), 0, 0
 from DESCRIPCION_EVENTO a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'DESCRIPCION_EVENTO', count(*)
 from DESCRIPCION_EVENTO a, errores b
 where b.table_name = 'DESCRIPCION_EVENTO'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'DESCRIPCION_EVENTO', count(*)
 from DESCRIPCION_EVENTO a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'EMPALME', count(*), 0, 0
 from EMPALME a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'EMPALME', count(*)
 from EMPALME a, errores b
 where b.table_name = 'EMPALME'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'EMPALME', count(*)
 from EMPALME a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;











insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ENMALLE', count(*), 0, 0
 from ENMALLE a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'ENMALLE', count(*)
 from ENMALLE a, errores b
 where b.table_name = 'ENMALLE'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ENMALLE', count(*)
 from ENMALLE a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'EQUIPO', count(*), 0, 0
 from EQUIPO a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'EQUIPO', count(*)
 from EQUIPO a, errores b
 where b.table_name = 'EQUIPO'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'EQUIPO', count(*)
 from EQUIPO a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'EQUIPO_TOPOLOGIA', count(*), 0, 0
 from EQUIPO_TOPOLOGIA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'EQUIPO_TOPOLOGIA', count(*)
 from EQUIPO_TOPOLOGIA a, errores b
 where b.table_name = 'EQUIPO_TOPOLOGIA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'EQUIPO_TOPOLOGIA', count(*)
 from EQUIPO_TOPOLOGIA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ESTRUCTURA_BT', count(*), 0, 0
 from ESTRUCTURA_BT a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'ESTRUCTURA_BT', count(*)
 from ESTRUCTURA_BT a, errores b
 where b.table_name = 'ESTRUCTURA_BT'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ESTRUCTURA_BT', count(*)
 from ESTRUCTURA_BT a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ESTRUCTURA_MT', count(*), 0, 0
 from ESTRUCTURA_MT a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'ESTRUCTURA_MT', count(*)
 from ESTRUCTURA_MT a, errores b
 where b.table_name = 'ESTRUCTURA_MT'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ESTRUCTURA_MT', count(*)
 from ESTRUCTURA_MT a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ESTRUCTURA_SED', count(*), 0, 0
 from ESTRUCTURA_SED a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'ESTRUCTURA_SED', count(*)
 from ESTRUCTURA_SED a, errores b
 where b.table_name = 'ESTRUCTURA_SED'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'ESTRUCTURA_SED', count(*)
 from ESTRUCTURA_SED a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'EVENTO_RED', count(*), 0, 0
 from EVENTO_RED a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'EVENTO_RED', count(*)
 from EVENTO_RED a, errores b
 where b.table_name = 'EVENTO_RED'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'EVENTO_RED', count(*)
 from EVENTO_RED a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'FUENTE_ENERGIA_RED', count(*), 0, 0
 from FUENTE_ENERGIA_RED a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'FUENTE_ENERGIA_RED', count(*)
 from FUENTE_ENERGIA_RED a, errores b
 where b.table_name = 'FUENTE_ENERGIA_RED'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'FUENTE_ENERGIA_RED', count(*)
 from FUENTE_ENERGIA_RED a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'INCIDENCIA', count(*), 0, 0
 from INCIDENCIA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'INCIDENCIA', count(*)
 from INCIDENCIA a, errores b
 where b.table_name = 'INCIDENCIA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'INCIDENCIA', count(*)
 from INCIDENCIA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'INTERRUPCION', count(*), 0, 0
 from INTERRUPCION a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'INTERRUPCION', count(*)
 from INTERRUPCION a, errores b
 where b.table_name = 'INTERRUPCION'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'INTERRUPCION', count(*)
 from INTERRUPCION a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'MARCA', count(*), 0, 0
 from MARCA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'MARCA', count(*)
 from MARCA a, errores b
 where b.table_name = 'MARCA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'MARCA', count(*)
 from MARCA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'MEDIDOR', count(*), 0, 0
 from MEDIDOR a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'MEDIDOR', count(*)
 from MEDIDOR a, errores b
 where b.table_name = 'MEDIDOR'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'MEDIDOR', count(*)
 from MEDIDOR a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'NODO_IEC', count(*), 0, 0
 from NODO_IEC a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'NODO_IEC', count(*)
 from NODO_IEC a, errores b
 where b.table_name = 'NODO_IEC'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'NODO_IEC', count(*)
 from NODO_IEC a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'NODO_IEC_CABECERA', count(*), 0, 0
 from NODO_IEC_CABECERA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'NODO_IEC_CABECERA', count(*)
 from NODO_IEC_CABECERA a, errores b
 where b.table_name = 'NODO_IEC_CABECERA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'NODO_IEC_CABECERA', count(*)
 from NODO_IEC_CABECERA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'NODO_IEC_EXTERNO', count(*), 0, 0
 from NODO_IEC_EXTERNO a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'NODO_IEC_EXTERNO', count(*)
 from NODO_IEC_EXTERNO a, errores b
 where b.table_name = 'NODO_IEC_EXTERNO'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'NODO_IEC_EXTERNO', count(*)
 from NODO_IEC_EXTERNO a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'NODO_INCIDENCIA', count(*), 0, 0
 from NODO_INCIDENCIA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'NODO_INCIDENCIA', count(*)
 from NODO_INCIDENCIA a, errores b
 where b.table_name = 'NODO_INCIDENCIA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'NODO_INCIDENCIA', count(*)
 from NODO_INCIDENCIA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'NODO_INCIDENCIA_CABECERA', count(*), 0, 0
 from NODO_INCIDENCIA_CABECERA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'NODO_INCIDENCIA_CABECERA', count(*)
 from NODO_INCIDENCIA_CABECERA a, errores b
 where b.table_name = 'NODO_INCIDENCIA_CABECERA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'NODO_INCIDENCIA_CABECERA', count(*)
 from NODO_INCIDENCIA_CABECERA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'NODO_INCIDENCIA_EXTERNO', count(*), 0, 0
 from NODO_INCIDENCIA_EXTERNO a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'NODO_INCIDENCIA_EXTERNO', count(*)
 from NODO_INCIDENCIA_EXTERNO a, errores b
 where b.table_name = 'NODO_INCIDENCIA_EXTERNO'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'NODO_INCIDENCIA_EXTERNO', count(*)
 from NODO_INCIDENCIA_EXTERNO a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'NODO_SUBESTACION', count(*), 0, 0
 from NODO_SUBESTACION a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'NODO_SUBESTACION', count(*)
 from NODO_SUBESTACION a, errores b
 where b.table_name = 'NODO_SUBESTACION'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'NODO_SUBESTACION', count(*)
 from NODO_SUBESTACION a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PERIODO_INFORMACION', count(*), 0, 0
 from PERIODO_INFORMACION a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'PERIODO_INFORMACION', count(*)
 from PERIODO_INFORMACION a, errores b
 where b.table_name = 'PERIODO_INFORMACION'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PERIODO_INFORMACION', count(*)
 from PERIODO_INFORMACION a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'POSTE', count(*), 0, 0
 from POSTE a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'POSTE', count(*)
 from POSTE a, errores b
 where b.table_name = 'POSTE'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'POSTE', count(*)
 from POSTE a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUENTE', count(*), 0, 0
 from PUENTE a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'PUENTE', count(*)
 from PUENTE a, errores b
 where b.table_name = 'PUENTE'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUENTE', count(*)
 from PUENTE a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_CONSUMO', count(*), 0, 0
 from PUNTO_CONSUMO a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_CONSUMO', count(*)
 from PUNTO_CONSUMO a, errores b
 where b.table_name = 'PUNTO_CONSUMO'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_CONSUMO', count(*)
 from PUNTO_CONSUMO a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_CONSUMO_TOPOLOGIA', count(*), 0, 0
 from PUNTO_CONSUMO_TOPOLOGIA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_CONSUMO_TOPOLOGIA', count(*)
 from PUNTO_CONSUMO_TOPOLOGIA a, errores b
 where b.table_name = 'PUNTO_CONSUMO_TOPOLOGIA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_CONSUMO_TOPOLOGIA', count(*)
 from PUNTO_CONSUMO_TOPOLOGIA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_DERIVACION', count(*), 0, 0
 from PUNTO_DERIVACION a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_DERIVACION', count(*)
 from PUNTO_DERIVACION a, errores b
 where b.table_name = 'PUNTO_DERIVACION'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_DERIVACION', count(*)
 from PUNTO_DERIVACION a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_DERIVACION_INCIDENCIA', count(*), 0, 0
 from PUNTO_DERIVACION_INCIDENCIA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_DERIVACION_INCIDENCIA', count(*)
 from PUNTO_DERIVACION_INCIDENCIA a, errores b
 where b.table_name = 'PUNTO_DERIVACION_INCIDENCIA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_DERIVACION_INCIDENCIA', count(*)
 from PUNTO_DERIVACION_INCIDENCIA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_FALLA', count(*), 0, 0
 from PUNTO_FALLA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_FALLA', count(*)
 from PUNTO_FALLA a, errores b
 where b.table_name = 'PUNTO_FALLA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_FALLA', count(*)
 from PUNTO_FALLA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_SUMINISTRO', count(*), 0, 0
 from PUNTO_SUMINISTRO a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_SUMINISTRO', count(*)
 from PUNTO_SUMINISTRO a, errores b
 where b.table_name = 'PUNTO_SUMINISTRO'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_SUMINISTRO', count(*)
 from PUNTO_SUMINISTRO a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_SUMINISTRO_INCIDENCIA', count(*), 0, 0
 from PUNTO_SUMINISTRO_INCIDENCIA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_SUMINISTRO_INCIDENCIA', count(*)
 from PUNTO_SUMINISTRO_INCIDENCIA a, errores b
 where b.table_name = 'PUNTO_SUMINISTRO_INCIDENCIA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'PUNTO_SUMINISTRO_INCIDENCIA', count(*)
 from PUNTO_SUMINISTRO_INCIDENCIA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;













insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'SUBESTACION_DISTRIBUCION', count(*), 0, 0
 from SUBESTACION_DISTRIBUCION a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'SUBESTACION_DISTRIBUCION', count(*)
 from SUBESTACION_DISTRIBUCION a, errores b
 where b.table_name = 'SUBESTACION_DISTRIBUCION'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'SUBESTACION_DISTRIBUCION', count(*)
 from SUBESTACION_DISTRIBUCION a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'SUBESTACION_INCIDENCIA', count(*), 0, 0
 from SUBESTACION_INCIDENCIA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'SUBESTACION_INCIDENCIA', count(*)
 from SUBESTACION_INCIDENCIA a, errores b
 where b.table_name = 'SUBESTACION_INCIDENCIA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'SUBESTACION_INCIDENCIA', count(*)
 from SUBESTACION_INCIDENCIA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'SUBESTACION_PRIMARIA_DISTRIBUC', count(*), 0, 0
 from SUBESTACION_PRIMARIA_DISTRIBUC a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'SUBESTACION_PRIMARIA_DISTRIBUC', count(*)
 from SUBESTACION_PRIMARIA_DISTRIBUC a, errores b
 where b.table_name = 'SUBESTACION_PRIMARIA_DISTRIBUC'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'SUBESTACION_PRIMARIA_DISTRIBUC', count(*)
 from SUBESTACION_PRIMARIA_DISTRIBUC a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'TIRANTE', count(*), 0, 0
 from TIRANTE a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'TIRANTE', count(*)
 from TIRANTE a, errores b
 where b.table_name = 'TIRANTE'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'TIRANTE', count(*)
 from TIRANTE a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'TOMA_TIERRA', count(*), 0, 0
 from TOMA_TIERRA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'TOMA_TIERRA', count(*)
 from TOMA_TIERRA a, errores b
 where b.table_name = 'TOMA_TIERRA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'TOMA_TIERRA', count(*)
 from TOMA_TIERRA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'TRAMO_BT', count(*), 0, 0
 from TRAMO_BT a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'TRAMO_BT', count(*)
 from TRAMO_BT a, errores b
 where b.table_name = 'TRAMO_BT'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'TRAMO_BT', count(*)
 from TRAMO_BT a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'TRAMO_MT', count(*), 0, 0
 from TRAMO_MT a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'TRAMO_MT', count(*)
 from TRAMO_MT a, errores b
 where b.table_name = 'TRAMO_MT'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'TRAMO_MT', count(*)
 from TRAMO_MT a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'TRANSFORMADOR', count(*), 0, 0
 from TRANSFORMADOR a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'TRANSFORMADOR', count(*)
 from TRANSFORMADOR a, errores b
 where b.table_name = 'TRANSFORMADOR'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'TRANSFORMADOR', count(*)
 from TRANSFORMADOR a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'TRANSFORMADOR_INTERRUPCION', count(*), 0, 0
 from TRANSFORMADOR_INTERRUPCION a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'TRANSFORMADOR_INTERRUPCION', count(*)
 from TRANSFORMADOR_INTERRUPCION a, errores b
 where b.table_name = 'TRANSFORMADOR_INTERRUPCION'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'TRANSFORMADOR_INTERRUPCION', count(*)
 from TRANSFORMADOR_INTERRUPCION a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'TRANSFORMADOR_TOPOLOGIA', count(*), 0, 0
 from TRANSFORMADOR_TOPOLOGIA a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'TRANSFORMADOR_TOPOLOGIA', count(*)
 from TRANSFORMADOR_TOPOLOGIA a, errores b
 where b.table_name = 'TRANSFORMADOR_TOPOLOGIA'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'TRANSFORMADOR_TOPOLOGIA', count(*)
 from TRANSFORMADOR_TOPOLOGIA a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'VERTICE_CANALIZACION', count(*), 0, 0
 from VERTICE_CANALIZACION a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'VERTICE_CANALIZACION', count(*)
 from VERTICE_CANALIZACION a, errores b
 where b.table_name = 'VERTICE_CANALIZACION'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'VERTICE_CANALIZACION', count(*)
 from VERTICE_CANALIZACION a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'VERTICE_EMPALME', count(*), 0, 0
 from VERTICE_EMPALME a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'VERTICE_EMPALME', count(*)
 from VERTICE_EMPALME a, errores b
 where b.table_name = 'VERTICE_EMPALME'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'VERTICE_EMPALME', count(*)
 from VERTICE_EMPALME a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'VERTICE_TRAMO_BT', count(*), 0, 0
 from VERTICE_TRAMO_BT a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'VERTICE_TRAMO_BT', count(*)
 from VERTICE_TRAMO_BT a, errores b
 where b.table_name = 'VERTICE_TRAMO_BT'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'VERTICE_TRAMO_BT', count(*)
 from VERTICE_TRAMO_BT a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







insert into resumen_carga(empresa_id, periodo_star_id, table_name, registros_enviados, registros_error,  registros_ok)
 select a.empresa_id, a.periodo_star_id, 'VERTICE_TRAMO_MT', count(*), 0, 0
 from VERTICE_TRAMO_MT a
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_error(empresa_id, periodo_star_id, table_name, registros_error)
 select a.empresa_id, a.periodo_star_id, 'VERTICE_TRAMO_MT', count(*)
 from VERTICE_TRAMO_MT a, errores b
 where b.table_name = 'VERTICE_TRAMO_MT'
  and a.rowid = b.rowid
 group by a.empresa_id, a.periodo_star_id;



insert into resumen_ok(empresa_id, periodo_star_id, table_name, registros_ok)
 select a.empresa_id, a.periodo_star_id, 'VERTICE_TRAMO_MT', count(*)
 from VERTICE_TRAMO_MT a
 where a.tiene_errores = 0
 group by a.empresa_id, a.periodo_star_id;







update resumen_carga
 set registros_enviados = (select registros_error
                            from resumen_error
                            where exists
                             (
                                select 1
                                from resumen_error b, resumen_carga a
                                where a.empresa_id = b.empresa_id
                                     and a.periodo_star_id  = b.periodo_star_id
                                     and a.table_name = b.table_name
                             ))
 where exists
  (
     select 1
     from resumen_error b, resumen_carga a
     where a.empresa_id = b.empresa_id
          and a.periodo_star_id  = b.periodo_star_id
          and a.table_name = b.table_name
  );


update resumen_carga
 set registros_ok = (select registros_ok
                            from resumen_ok
                            where exists
                             (
                                select 1
                                from resumen_ok b, resumen_carga a
                                where a.empresa_id = b.empresa_id
                                     and a.periodo_star_id  = b.periodo_star_id
                                     and a.table_name = b.table_name
                             ))
  where exists
   (
      select 1
      from resumen_ok b, resumen_carga a
      where a.empresa_id = b.empresa_id
           and a.periodo_star_id  = b.periodo_star_id
           and a.table_name = b.table_name
   );
